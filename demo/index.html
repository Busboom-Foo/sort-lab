<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sort Lab - Sorting Algorithm Visualizer</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f0f0f0;
    }
    
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .visualizer-container {
      height: 400px;
      margin-bottom: 20px;
    }
    
    .algorithm-selector {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }
    
    .algorithm-selector button {
      margin: 0 5px;
      padding: 10px 15px;
      background-color: #4a6cf7;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .algorithm-selector button:hover {
      background-color: #3a5ce5;
    }
    
    .algorithm-info {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .algorithm-info h2 {
      margin-top: 0;
      color: #444;
    }
    
    .algorithm-info p {
      line-height: 1.6;
      color: #666;
    }
    
    #debug-output {
      max-width: 800px;
      margin: 20px auto;
      padding: 10px;
      background-color: #f8f9fa;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-family: monospace;
      white-space: pre-wrap;
      max-height: 200px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Sort Lab - Sorting Algorithm Visualizer</h1>
    
    <div id="visualizer" class="visualizer-container"></div>
    
    <div class="algorithm-selector">
      <button id="bubble-sort">Bubble Sort</button>
      <button id="selection-sort">Selection Sort</button>
      <button id="insertion-sort">Insertion Sort</button>
      <button id="quick-sort">Quick Sort</button>
      <button id="merge-sort">Merge Sort</button>
    </div>
    
    <div class="algorithm-info">
      <h2 id="algorithm-title">Select an Algorithm</h2>
      <p id="algorithm-description">Click on one of the algorithm buttons above to start the visualization and learn about the algorithm.</p>
      <p id="algorithm-complexity"></p>
    </div>
    
    <div id="debug-output">Debug output will appear here</div>
  </div>
  
  <script src="/dist/bundle.js"></script>
  <script>
    // Debug console override
    const debugOutput = document.getElementById('debug-output');
    const originalConsoleLog = console.log;
    const originalConsoleError = console.error;
    
    console.log = function(...args) {
      originalConsoleLog.apply(console, args);
      debugOutput.textContent += args.map(arg => 
        typeof arg === 'object' ? JSON.stringify(arg) : arg
      ).join(' ') + '\n';
      debugOutput.scrollTop = debugOutput.scrollHeight;
    };
    
    console.error = function(...args) {
      originalConsoleError.apply(console, args);
      debugOutput.innerHTML += '<span style="color: red;">' + 
        args.map(arg => typeof arg === 'object' ? JSON.stringify(arg) : arg).join(' ') + 
        '</span>\n';
      debugOutput.scrollTop = debugOutput.scrollHeight;
    };
    document.addEventListener('DOMContentLoaded', async () => {
      console.log('DOM loaded, SortVisualizer available:', typeof SortVisualizer !== 'undefined');
      
      // Initialize the visualizer
      const visualizer = new SortVisualizer.SortVisualizer({
        container: '#visualizer',
        elementCount: 50,
        showControls: true
      });
      
      // Manually start the visualizer to make sure it's ready
      visualizer.start();
      
      // Algorithm information
      const algorithmInfo = {
        bubble: {
          title: 'Bubble Sort',
          description: 'Bubble Sort is a simple sorting algorithm that repeatedly steps through the list, compares adjacent elements, and swaps them if they are in the wrong order. The pass through the list is repeated until the list is sorted.',
          complexity: 'Time Complexity: O(n²) | Space Complexity: O(1)'
        },
        selection: {
          title: 'Selection Sort',
          description: 'Selection Sort divides the input list into two parts: a sorted sublist and an unsorted sublist. It repeatedly finds the minimum element from the unsorted sublist and moves it to the sorted sublist.',
          complexity: 'Time Complexity: O(n²) | Space Complexity: O(1)'
        },
        insertion: {
          title: 'Insertion Sort',
          description: 'Insertion Sort builds the sorted array one item at a time. It takes one element from the unsorted part and inserts it into its correct position in the sorted part.',
          complexity: 'Time Complexity: O(n²) | Space Complexity: O(1)'
        },
        quick: {
          title: 'Quick Sort',
          description: 'Quick Sort selects a pivot element and partitions the array around it. Elements less than the pivot go to the left, and elements greater go to the right. The subarrays are then recursively sorted.',
          complexity: 'Time Complexity: O(n log n) average, O(n²) worst | Space Complexity: O(log n)'
        },
        merge: {
          title: 'Merge Sort',
          description: 'Merge Sort divides the input array into two halves, recursively sorts them, and then merges the sorted halves to produce a sorted output.',
          complexity: 'Time Complexity: O(n log n) | Space Complexity: O(n)'
        }
      };
      
      // Update info panel
      function updateInfo(algorithm) {
        document.getElementById('algorithm-title').textContent = algorithmInfo[algorithm].title;
        document.getElementById('algorithm-description').textContent = algorithmInfo[algorithm].description;
        document.getElementById('algorithm-complexity').textContent = algorithmInfo[algorithm].complexity;
      }
      
      // Run algorithms
      document.getElementById('bubble-sort').addEventListener('click', async () => {
        visualizer.reset();
        updateInfo('bubble');
        visualizer.start(); // Make sure to start the animation
        try {
          // Log that we're trying to run the algorithm
          console.log("Running bubble sort");
          // Access the SortAlgorithms class directly 
          await SortVisualizer.SortAlgorithms.bubbleSort(visualizer);
        } catch (error) {
          console.error('Error during bubble sort:', error);
        }
      });
      
      document.getElementById('selection-sort').addEventListener('click', async () => {
        visualizer.reset();
        updateInfo('selection');
        visualizer.start(); // Make sure to start the animation
        try {
          await SortVisualizer.SortAlgorithms.selectionSort(visualizer);
        } catch (error) {
          console.error('Error during selection sort:', error);
        }
      });
      
      document.getElementById('insertion-sort').addEventListener('click', async () => {
        visualizer.reset();
        updateInfo('insertion');
        visualizer.start(); // Make sure to start the animation
        try {
          await SortVisualizer.SortAlgorithms.insertionSort(visualizer);
        } catch (error) {
          console.error('Error during insertion sort:', error);
        }
      });
      
      document.getElementById('quick-sort').addEventListener('click', async () => {
        visualizer.reset();
        updateInfo('quick');
        visualizer.start(); // Make sure to start the animation
        try {
          await SortVisualizer.SortAlgorithms.quickSort(visualizer);
        } catch (error) {
          console.error('Error during quick sort:', error);
        }
      });
      
      document.getElementById('merge-sort').addEventListener('click', async () => {
        visualizer.reset();
        updateInfo('merge');
        visualizer.start(); // Make sure to start the animation
        try {
          await SortVisualizer.SortAlgorithms.mergeSort(visualizer);
        } catch (error) {
          console.error('Error during merge sort:', error);
        }
      });
    });
    
    // Log available libraries to debug
    console.log("Available library objects:", Object.keys(SortVisualizer));
  </script>
</body>
</html>
